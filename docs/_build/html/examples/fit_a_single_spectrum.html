

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example of a single spectrum fit. &mdash; orcs  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How precise must be the input velocity parameter ?" href="velocity_parameter_precision.html" />
    <link rel="prev" title="Examples" href="../examples.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> orcs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../examples.html#first-basic-examples">First basic examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Example of a single spectrum fit.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#First-step:-extracting-and-viewing-the-spectrum">First step: extracting and viewing the spectrum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Second-step:-fitting-the-spectrum">Second step: fitting the spectrum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="velocity_parameter_precision.html">How precise must be the input velocity parameter ?</a></li>
<li class="toctree-l3"><a class="reference internal" href="deep_wcs.html">Extract the deep frame and use the WCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="fit_region.html">Make a fit over an entire region of the field</a></li>
<li class="toctree-l3"><a class="reference internal" href="sincgauss_vs_2_sinc.html">Differences between fitting a sincgauss model and two sinc lines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#bayesian-fitting-vs-classical-fitting">Bayesian fitting vs. classical fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#calibrating-your-data">Calibrating your data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#advanced-fitting">Advanced fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html#other-tools">Other Tools</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core_module.html">Core module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process_module.html">Process module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils_module.html">Utils module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">orcs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Example of a single spectrum fit.</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/fit_a_single_spectrum.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 5ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Example-of-a-single-spectrum-fit.">
<h1>Example of a single spectrum fit.<a class="headerlink" href="#Example-of-a-single-spectrum-fit." title="Permalink to this headline">¶</a></h1>
<div class="section" id="First-step:-extracting-and-viewing-the-spectrum">
<h2>First step: extracting and viewing the spectrum<a class="headerlink" href="#First-step:-extracting-and-viewing-the-spectrum" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span># import base class for the manipulation of a SITELLE spectral cube: HDFCube
from orcs.core import HDFCube
import pylab as pl
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span># load spectral cube
cube = HDFCube(&#39;M31_SN3.merged.cm1.1.0.hdf5&#39;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO| Data shape : (2048, 2064, 840)
INFO| Cube is in WAVENUMBER (cm-1)
INFO| Cube is CALIBRATED in wavenumber
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span># extract and plot a spectrum at x=919 y=893 integrated over a radius of 2 pixels
axis, spectrum = cube.extract_spectrum(919, 893, 2)
pl.plot(axis, spectrum)
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO| Number of integrated pixels: 13
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 0.080 s]
 [==========] [100%] [completed in 0.074 s]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x7f15ae0eba90&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_fit_a_single_spectrum_3_3.png" src="../_images/examples_fit_a_single_spectrum_3_3.png" />
</div>
</div>
</div>
<div class="section" id="Second-step:-fitting-the-spectrum">
<h2>Second step: fitting the spectrum<a class="headerlink" href="#Second-step:-fitting-the-spectrum" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The emission lines to fit are passed by name (their wavenumber, in cm-1, could also be given directly). Remember that:</li>
</ul>
<p><span class="math">\sigma [\text{cm}^{-1}] = \frac{1e7}{\lambda [\text{nm}]}</span></p>
<ul class="simple">
<li>The line model is <code class="docutils literal notranslate"><span class="pre">gaussian</span></code> by default. Here we use the more realistic model of a cardinal sinus convoluted with a gaussian <code class="docutils literal notranslate"><span class="pre">sincgauss</span></code>:</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">python</span>&#160;&#160; <span class="pre">fmodel</span> <span class="pre">=</span> <span class="pre">'sinc'</span></code></p>
<ul class="simple">
<li>The velocity of the lines is -513 km/s. It is passed with the argument:</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">python</span>&#160;&#160; <span class="pre">pos_cov</span> <span class="pre">=</span> <span class="pre">-513`,</span>&#160;&#160; <span class="pre">pos_def</span> <span class="pre">=</span> <span class="pre">['1','1']</span></code></p>
<p>The velocity is considered as a covarying parameter. By default all the lines are considered to have a free velocity parameter. If we want to set the same velocity to all the lines we must set the definition of the position of eachline to the same covaying group with <code class="docutils literal notranslate"><span class="pre">pos_def</span> <span class="pre">=</span> <span class="pre">['1','1']</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>axis, spectrum, fit_res = cube.fit_lines_in_spectrum(919, 893, 2, [&#39;Halpha&#39;, &#39;[NII]6583&#39;],
                                                     fmodel=&#39;sinc&#39;,
                                                     pos_cov=-513,
                                                     pos_def=[&#39;1&#39;, &#39;1&#39;])
print &#39;\n===== Results ======&#39;
print &#39;Velocity: &#39;, fit_res[&#39;velocity_gvar&#39;]
print &#39;Flux: &#39;, fit_res[&#39;flux_gvar&#39;]
print &#39;====================&#39;
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO| Number of integrated pixels: 13
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 0.036 s]
 [==========] [100%] [completed in 0.081 s]

===== Results ======
Velocity:  [-508.3(1.0) -508.3(1.0)]
Flux:  [1.181(44)e-15 2.95(44)e-16]
====================
</pre></div></div>
</div>
<div class="section" id="Ungroup-the-velocity-parameter">
<h3>Ungroup the velocity parameter<a class="headerlink" href="#Ungroup-the-velocity-parameter" title="Permalink to this headline">¶</a></h3>
<p>We can ungroup the velocity of the emission lines by giving each line a unique group label. We can set:</p>
<p><code class="docutils literal notranslate"><span class="pre">pos_def=['1',</span> <span class="pre">'2']</span></code></p>
<p>I this case the measured velocity must be different for both lines. But the precision will also be worsen.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>axis, spectrum, fit_res = cube.fit_lines_in_spectrum(919, 893, 2, [&#39;Halpha&#39;, &#39;[NII]6583&#39;],
                                                     fmodel=&#39;sinc&#39;,
                                                     pos_cov=(-513, -513),
                                                     pos_def=[&#39;1&#39;, &#39;2&#39;])
print &#39;\n===== Results ======&#39;
print &#39;Velocity: &#39;, fit_res[&#39;velocity_gvar&#39;]
print &#39;Flux: &#39;, fit_res[&#39;flux_gvar&#39;]
print &#39;====================&#39;
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO| Number of integrated pixels: 13
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 0.030 s]
 [==========] [100%] [completed in 0.076 s]

===== Results ======
Velocity:  [-507.8(1.1) -515.3(4.2)]
Flux:  [1.182(44)e-15 3.01(44)e-16]
====================
</pre></div></div>
</div>
</div>
<div class="section" id="using-a-sincgauss-model-with-a-single-broadening-parameter">
<h3>using a sincgauss model with a single broadening parameter<a class="headerlink" href="#using-a-sincgauss-model-with-a-single-broadening-parameter" title="Permalink to this headline">¶</a></h3>
<p>We can try the broadened sincgauss model (sinc instrumental function convoluted with a gaussian). We can group the broadening parameter of the emission lines by giving the same group label to the lines. We can set:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span>&#160;&#160; <span class="pre">fmodel='sincgauss',</span>&#160;&#160; <span class="pre">sigma_def=['1',</span> <span class="pre">'1'],</span>&#160;&#160; <span class="pre">sigma_cov=20</span></code></p>
<p>I this case the measured broadening will be the same for both lines and the precision of the estimations are better. Note that the broadening must be initialized to a nonzero value for the fit to work <code class="docutils literal notranslate"><span class="pre">sigma_cov=20</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>axis, spectrum, fit_res = cube.fit_lines_in_spectrum(
    919, 893, 2, [&#39;Halpha&#39;, &#39;[NII]6583&#39;],
    fmodel=&#39;sincgauss&#39;,
    pos_cov=-513,
    pos_def=[&#39;1&#39;, &#39;1&#39;],
    sigma_def=[&#39;1&#39;, &#39;1&#39;],
    sigma_cov=20)
print &#39;\n===== Results ======&#39;
print &#39;Velocity: &#39;, fit_res[&#39;velocity_gvar&#39;]
print &#39;Broadening: &#39;, fit_res[&#39;broadening_gvar&#39;]
print &#39;Flux: &#39;, fit_res[&#39;flux_gvar&#39;]
print &#39;====================&#39;
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO| Number of integrated pixels: 13
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 0.031 s]
 [==========] [100%] [completed in 0.077 s]

===== Results ======
Velocity:  [-507.4(1.3) -507.4(1.3)]
Broadening:  [25.9(1.6) 25.9(1.6)]
Flux:  [1.681(86)e-15 4.39(59)e-16]
====================
</pre></div></div>
</div>
</div>
<div class="section" id="Plotting-the-result">
<h3>Plotting the result<a class="headerlink" href="#Plotting-the-result" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>pl.plot(axis, spectrum, label=&#39;Real spectrum&#39;)
pl.plot(axis, fit_res[&#39;fitted_vector&#39;], label=&#39;Fitted spectrum&#39;)
pl.legend()
pl.xlim((14500, 15500))
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(14500, 15500)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_fit_a_single_spectrum_11_1.png" src="../_images/examples_fit_a_single_spectrum_11_1.png" />
</div>
</div>
</div>
<div class="section" id="Model-with-no-filter">
<h3>Model with no filter<a class="headerlink" href="#Model-with-no-filter" title="Permalink to this headline">¶</a></h3>
<p>The filter model can be removed but the range over which the fit is made must be limited to the filter bandpass. This is made transparently by setting the option</p>
<p><code class="docutils literal notranslate"><span class="pre">nofilter</span> <span class="pre">=</span> <span class="pre">True</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre>
<span></span>axis, spectrum, fit_res = cube.fit_lines_in_spectrum(
    919, 893, 2, [&#39;Halpha&#39;, &#39;[NII]6583&#39;],
    fmodel=&#39;sincgauss&#39;,
    pos_cov=-513,
    pos_def=[&#39;1&#39;, &#39;1&#39;],
    sigma_def=[&#39;1&#39;, &#39;1&#39;],
    sigma_cov=20,
    nofilter=True)
print &#39;\n===== Results ======&#39;
print &#39;Velocity: &#39;, fit_res[&#39;velocity_gvar&#39;]
print &#39;Broadening: &#39;, fit_res[&#39;broadening_gvar&#39;]
print &#39;Flux: &#39;, fit_res[&#39;flux_gvar&#39;]
print &#39;====================&#39;
pl.plot(axis, spectrum, label=&#39;Real spectrum&#39;)
pl.plot(axis, fit_res[&#39;fitted_vector&#39;], label=&#39;Fitted spectrum&#39;)
pl.legend()
pl.xlim((14500, 15500))
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO| Number of integrated pixels: 13
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 [==========] [100%] [completed in 0.043 s]
 [==========] [100%] [completed in 0.087 s]

===== Results ======
Velocity:  [-507.3(1.5) -507.3(1.5)]
Broadening:  [26.2(1.8) 26.2(1.8)]
Flux:  [1.676(98)e-15 4.45(68)e-16]
====================
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(14500, 15500)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_fit_a_single_spectrum_13_3.png" src="../_images/examples_fit_a_single_spectrum_13_3.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="velocity_parameter_precision.html" class="btn btn-neutral float-right" title="How precise must be the input velocity parameter ?" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../examples.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Thomas Martin

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>